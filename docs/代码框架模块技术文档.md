# å°èˆªæ™ºèƒ½è¾…å¯¼ç³»ç»Ÿ - ä»£ç æ¡†æ¶æ¨¡å—æŠ€æœ¯æ–‡æ¡£

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 æ¨¡å—ç›®æ ‡
ä»£ç æ¡†æ¶æ¨¡å—æ—¨åœ¨å¸®åŠ©å­¦ç”Ÿç†è§£ç¨‹åºè®¾è®¡çš„æ ¸å¿ƒæ€æƒ³ï¼š
- **ç¨‹åºç”±ä¸‰ç§æ§åˆ¶ç»“æ„ç»„æˆ**ï¼šé¡ºåºã€é€‰æ‹©ã€å¾ªç¯
- **å¤æ‚é—®é¢˜å±‚æ¬¡åŒ–åˆ†è§£**ï¼šè‡ªé¡¶å‘ä¸‹ã€é€æ­¥æ±‚ç²¾
- **ISPOæ¨¡å‹æè¿°**ï¼šæ¯ä¸ªæ¨¡å—ç”¨è¾“å…¥-å­˜å‚¨-å¤„ç†-è¾“å‡ºæè¿°
- **äº¤äº’å¼å­¦ä¹ **ï¼šæ¯å±‚åˆ†è§£åè¯¢é—®å­¦ç”Ÿæ˜¯å¦èƒ½å†™å‡ºä»£ç 

### 1.2 æŠ€æœ¯æ ˆ
| å±‚çº§ | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| å‰ç«¯ | HTML5 + CSS3 + JavaScript | é¡µé¢ç»“æ„ä¸äº¤äº’ |
| å¯è§†åŒ– | çº¯CSSåŠ¨ç”» + Flexboxå¸ƒå±€ | æµç¨‹å›¾æ¸²æŸ“ |
| åç«¯ | Python Flask | APIæœåŠ¡ |
| AI | å¤§è¯­è¨€æ¨¡å‹(LLM) | æ™ºèƒ½åˆ†è§£ç”Ÿæˆ |
| å­˜å‚¨ | Redis | ä¼šè¯çŠ¶æ€ç®¡ç† |
| éƒ¨ç½² | Docker + Docker Compose | å®¹å™¨åŒ–éƒ¨ç½² |

---

## äºŒã€ç³»ç»Ÿæ¶æ„

### 2.1 æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯ (Browser)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ xiaohang_   â”‚  â”‚ xiaohang_   â”‚  â”‚ xiaohang_framework  â”‚  â”‚
â”‚  â”‚ v3.html     â”‚  â”‚ enhanced.js â”‚  â”‚ .js                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                    â”‚
          â–¼                â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Flask API Server                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              app_xiaohang_enhanced.py                â”‚    â”‚
â”‚  â”‚  â€¢ /api/xiaohang/get_guidance (æ¡†æ¶ç”Ÿæˆ)             â”‚    â”‚
â”‚  â”‚  â€¢ /api/xiaohang/decompose_problem (ç»§ç»­åˆ†è§£)        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Redis         â”‚                   â”‚   LLM API       â”‚
â”‚   (ä¼šè¯å­˜å‚¨)     â”‚                   â”‚   (AIç”Ÿæˆ)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | ä½œç”¨ |
|------|------|
| `static/xiaohang_v3.html` | ä¸»é¡µé¢ï¼ŒåŒ…å«å¼¹çª—ã€æ ·å¼ã€é¡µé¢ç»“æ„ |
| `static/xiaohang_framework.js` | æ ¸å¿ƒå¯è§†åŒ–æ¨¡å—ï¼ŒåŒ…å«å›¾è¡¨ç”Ÿæˆå™¨ |
| `static/xiaohang_enhanced.js` | åŸºç¡€äº¤äº’åŠŸèƒ½ï¼ˆé¢˜ç›®ç”Ÿæˆã€ä»£ç æäº¤ç­‰ï¼‰ |
| `app_xiaohang_enhanced.py` | åç«¯APIï¼Œå¤„ç†æ¡†æ¶ç”Ÿæˆè¯·æ±‚ |

---

## ä¸‰ã€æ ¸å¿ƒè®¾è®¡æ€æƒ³

### 3.1 ç¨‹åºè®¾è®¡ä¸‰ç§æ§åˆ¶ç»“æ„

```javascript
const ControlStructures = {
    SEQUENCE: {
        type: 'sequence',
        name: 'é¡ºåºç»“æ„',
        icon: 'ğŸ“‹',
        color: '#3498db',      // è“è‰²
        description: 'æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œçš„è¯­å¥å—'
    },
    SELECTION: {
        type: 'selection',
        name: 'é€‰æ‹©ç»“æ„',
        icon: 'ğŸ”€',
        color: '#e74c3c',      // çº¢è‰²
        description: 'if-elseã€switchç­‰æ¡ä»¶åˆ†æ”¯'
    },
    LOOP: {
        type: 'loop',
        name: 'å¾ªç¯ç»“æ„',
        icon: 'ğŸ”„',
        color: '#27ae60',      // ç»¿è‰²
        description: 'forã€whileç­‰å¾ªç¯è¯­å¥'
    }
};
```

### 3.2 ISPOæ¨¡å‹

æ¯ä¸ªæ¨¡å—éƒ½ç”¨ **è¾“å…¥-å­˜å‚¨-å¤„ç†-è¾“å‡º** æ¨¡å‹æè¿°ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ“¥ è¾“å…¥   â”‚ â”€â”€â–¶ â”‚   ğŸ’¾ å­˜å‚¨   â”‚ â”€â”€â–¶ â”‚   âš™ï¸ å¤„ç†   â”‚ â”€â”€â–¶ â”‚   ğŸ“¤ è¾“å‡º   â”‚
â”‚   (Input)   â”‚     â”‚  (Storage)  â”‚     â”‚  (Process)  â”‚     â”‚  (Output)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 å±‚æ¬¡åŒ–åˆ†è§£æµç¨‹

```
ç¬¬1å±‚åˆ†è§£
    ä¸»é—®é¢˜
       â”‚
    â”Œâ”€â”€â”´â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
    â–¼     â–¼      â–¼
  æ¨¡å—A  æ¨¡å—B  æ¨¡å—C
    â”‚
    â–¼ (ç”¨æˆ·é€‰æ‹©"éœ€è¦ç»§ç»­åˆ†è§£")
    
ç¬¬2å±‚åˆ†è§£
  æ¨¡å—A
    â”‚
  â”Œâ”€â”´â”€â”¬â”€â”€â”€â”
  â–¼   â–¼   â–¼
 A1  A2  A3
```

---

## å››ã€å‰ç«¯å®ç°è¯¦è§£

### 4.1 å¼¹çª—è®¾è®¡

ä½¿ç”¨å…¨å±æ¨¡æ€æ¡†å±•ç¤ºæ¡†æ¶å†…å®¹ï¼Œè§£å†³å³ä¾§åŒºåŸŸè¿‡å°çš„é—®é¢˜ï¼š

```html
<!-- ä»£ç æ¡†æ¶å¼¹çª— -->
<div id="framework-modal" class="framework-modal">
    <div class="framework-modal-content">
        <div class="framework-modal-header">
            <h3>ğŸ—ï¸ ä»£ç æ¡†æ¶ - å±‚æ¬¡åŒ–åˆ†è§£</h3>
            <button onclick="closeFrameworkModal()">âœ•</button>
        </div>
        <div id="framework-content" class="framework-modal-body"></div>
    </div>
</div>
```

```css
.framework-modal {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2000;
}

.framework-modal-content {
    width: 90%;
    max-width: 1200px;
    height: 85vh;
    background: white;
    border-radius: 20px;
    animation: modalSlideIn 0.3s ease;
}
```

### 4.2 ç¾è§‚çš„æµç¨‹å›¾å®ç°

æ”¾å¼ƒMermaid.jsï¼Œé‡‡ç”¨çº¯HTML+CSSå®ç°æ›´ç¾è§‚çš„æµç¨‹å›¾ï¼š

#### åˆ†è§£ç»“æ„å›¾
```javascript
generateBeautifulDecompositionChart(data) {
    return `
    <div class="beautiful-decomposition">
        <!-- çˆ¶é—®é¢˜èŠ‚ç‚¹ -->
        <div class="decomp-parent">
            <div class="parent-icon">ğŸ¯</div>
            <div class="parent-text">${data.parentProblem}</div>
        </div>
        
        <!-- è¿æ¥çº¿ -->
        <div class="decomp-connector">...</div>
        
        <!-- å­æ¨¡å—èŠ‚ç‚¹ -->
        <div class="decomp-children">
            ${data.subProblems.map(sub => `
                <div class="child-card child-${sub.controlType}">
                    <div class="child-icon">${ctrl.icon}</div>
                    <div class="child-name">${sub.name}</div>
                </div>
            `).join('')}
        </div>
    </div>
    `;
}
```

#### æ§åˆ¶æµç¨‹å›¾
```javascript
generateBeautifulFlowChart(subProblems) {
    return `
    <div class="beautiful-flow-chart">
        <!-- å¼€å§‹èŠ‚ç‚¹ -->
        <div class="flow-node flow-start">ğŸš€ å¼€å§‹</div>
        
        <!-- æ­¥éª¤èŠ‚ç‚¹ï¼ˆæ ¹æ®æ§åˆ¶ç»“æ„ç±»å‹æ˜¾ç¤ºä¸åŒå½¢çŠ¶ï¼‰ -->
        ${subProblems.map(sub => `
            <div class="flow-arrow">â–¼</div>
            <div class="flow-node flow-${sub.controlType}">
                ${sub.name}
            </div>
        `).join('')}
        
        <!-- ç»“æŸèŠ‚ç‚¹ -->
        <div class="flow-arrow">â–¼</div>
        <div class="flow-node flow-end">âœ… ç»“æŸ</div>
    </div>
    `;
}
```

### 4.3 ä¸åŒæ§åˆ¶ç»“æ„çš„è§†è§‰åŒºåˆ†

```css
/* é¡ºåºç»“æ„ - åœ†è§’çŸ©å½¢ */
.flow-sequence {
    border-radius: 12px;
    background: #e8f4fd;
    border: 3px solid #3498db;
}

/* é€‰æ‹©ç»“æ„ - è±å½¢ */
.flow-selection {
    clip-path: polygon(15% 0%, 85% 0%, 100% 50%, 85% 100%, 15% 100%, 0% 50%);
    background: #fce4ec;
    border: 3px solid #e74c3c;
}

/* å¾ªç¯ç»“æ„ - èƒ¶å›Šå½¢ */
.flow-loop {
    border-radius: 25px;
    background: #e8f5e9;
    border: 3px solid #27ae60;
}
```

---

## äº”ã€åç«¯å®ç°è¯¦è§£

### 5.1 æ¡†æ¶ç”ŸæˆAPI

```python
@xiaohang_enhanced_bp.route('/get_guidance', methods=['POST'])
def get_guidance():
    guidance_type = request.json.get('type')  # 'æ¡†æ¶'
    
    if guidance_type == 'æ¡†æ¶':
        # æ„å»ºæç¤ºè¯ï¼Œè¦æ±‚AIè¿”å›JSONæ ¼å¼
        prompt = """ä½ æ˜¯ä¸€åç¨‹åºè®¾è®¡æ•™å­¦ä¸“å®¶ã€‚è¯·å°†é—®é¢˜åˆ†è§£ä¸ºå­æ¨¡å—ã€‚

ã€é‡è¦ã€‘ï¼šä½ å¿…é¡»è¾“å‡ºä¸€ä¸ªç”¨ ```json å’Œ ``` åŒ…è£¹çš„JSONå¯¹è±¡ï¼š

```json
{
    "parentProblem": "é—®é¢˜æè¿°",
    "level": 1,
    "subProblems": [
        {
            "name": "æ¨¡å—å",
            "controlType": "sequence|selection|loop",
            "ipo": {"input": "...", "process": "...", "output": "..."},
            "needsFurtherDecomposition": true/false,
            "codeHint": "è¯­å¥æç¤ºï¼ˆè‡ªç„¶è¯­è¨€æè¿°ï¼‰"
        }
    ],
    "overallIPO": {"input": "...", "process": "...", "output": "..."}
}
```
"""
        
        # æµå¼è°ƒç”¨LLM
        for chunk in llm._call(prompt):
            yield chunk
```

### 5.2 ç»§ç»­åˆ†è§£API

```python
@xiaohang_enhanced_bp.route('/decompose_problem', methods=['POST'])
def decompose_problem():
    level = request.json.get('level')  # åˆ†è§£å±‚çº§
    sub_problem_index = request.json.get('subProblemIndex')  # è¦åˆ†è§£çš„å­é—®é¢˜
    
    # è·å–ä¹‹å‰çš„åˆ†è§£å†å²
    previous_decomposition = redis_client.get(decomposition_key)
    
    # æ„å»ºæç¤ºè¯ï¼Œè¿›è¡Œæ›´ç»†ç²’åº¦çš„åˆ†è§£
    prompt = f"""è¯·å¯¹ä»¥ä¸‹é—®é¢˜è¿›è¡Œç¬¬{level}å±‚åˆ†è§£..."""
    
    for chunk in llm._call(prompt):
        yield chunk
```

### 5.3 JSONè§£æå®¹é”™å¤„ç†

å‰ç«¯éœ€è¦å¤„ç†AIè¿”å›çš„JSONå¯èƒ½ä¸å®Œæ•´çš„æƒ…å†µï¼š

```javascript
async function parseAndVisualizeFramework(text, container) {
    let jsonStr = null;
    
    // æ–¹æ³•1: æå– ```json ``` åŒ…è£¹çš„å†…å®¹
    const jsonMatch = text.match(/```json\s*([\s\S]*?)\s*```/);
    if (jsonMatch) jsonStr = jsonMatch[1];
    
    // æ–¹æ³•2: ç›´æ¥æŸ¥æ‰¾JSONå¯¹è±¡
    if (!jsonStr) {
        const match = text.match(/\{[\s\S]*"parentProblem"[\s\S]*\}/);
        if (match) jsonStr = match[0];
    }
    
    // æ–¹æ³•3: ä¿®å¤ä¸å®Œæ•´çš„JSON
    if (jsonStr) {
        jsonStr = tryFixIncompleteJson(jsonStr);
        const data = JSON.parse(jsonStr);
        await FrameworkVisualizer.renderFullVisualization(data, container);
    }
}
```

---

## å…­ã€ç”¨æˆ·äº¤äº’æµç¨‹

### 6.1 å®Œæ•´äº¤äº’æµç¨‹å›¾

```
ç”¨æˆ·ç‚¹å‡»"ä»£ç æ¡†æ¶"æŒ‰é’®
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰“å¼€å…¨å±å¼¹çª—      â”‚
â”‚  æ˜¾ç¤ºåŠ è½½åŠ¨ç”»      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è°ƒç”¨åç«¯API       â”‚
â”‚  æµå¼æ¥æ”¶AIå“åº”    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è§£æJSONæ•°æ®      â”‚
â”‚  æ¸²æŸ“å¯è§†åŒ–å›¾è¡¨    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ˜¾ç¤ºæ¯ä¸ªå­æ¨¡å—çš„IPOå¡ç‰‡               â”‚
â”‚  è¯¢é—®ç”¨æˆ·ï¼š"ä½ èƒ½å†™å‡ºè¿™éƒ¨åˆ†ä»£ç å—ï¼Ÿ"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â–¼           â–¼     â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¯ä»¥  â”‚   â”‚ éœ€è¦ç»§ç»­åˆ†è§£           â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                   â”‚
    â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ˜¾ç¤ºæˆåŠŸ   â”‚   â”‚ è°ƒç”¨åˆ†è§£API        â”‚
â”‚ å¼•å¯¼å†™ä»£ç  â”‚   â”‚ æ˜¾ç¤ºç¬¬N+1å±‚åˆ†è§£    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ç”¨æˆ·é€‰æ‹©å¤„ç†

```javascript
// ç”¨æˆ·è¡¨ç¤ºå¯ä»¥å†™å‡ºä»£ç 
function handleUserCanWrite(uniqueId, index, level) {
    const promptCard = document.getElementById(`prompt-${uniqueId}`);
    promptCard.innerHTML = `
        <div style="background: #d4edda; padding: 24px; text-align: center;">
            <div style="font-size: 48px;">âœ…</div>
            <h4>å¤ªæ£’äº†ï¼</h4>
            <p>ä½ å·²ç»ç†è§£äº†è¿™ä¸ªæ¨¡å—ï¼Œç°åœ¨å¯ä»¥åœ¨ä»£ç ç¼–è¾‘å™¨ä¸­å®ç°å®ƒäº†</p>
        </div>
    `;
    
    // æ»šåŠ¨åˆ°ä»£ç ç¼–è¾‘å™¨
    document.getElementById('code-editor').scrollIntoView();
}

// ç”¨æˆ·éœ€è¦ç»§ç»­åˆ†è§£
async function handleUserNeedDecompose(uniqueId, index, level) {
    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    promptCard.innerHTML = 'æ­£åœ¨è¿›è¡Œæ›´ç»†ç²’åº¦çš„åˆ†è§£...';
    
    // è°ƒç”¨API
    const response = await fetch('/api/xiaohang/decompose_problem', {
        method: 'POST',
        body: JSON.stringify({ level: level + 1, subProblemIndex: index })
    });
    
    // æ¸²æŸ“æ–°çš„åˆ†è§£ç»“æœ
    const newData = parseJSON(await response.text());
    await FrameworkVisualizer.renderFullVisualization(newData, container);
}
```

---

## ä¸ƒã€å…³é”®æŠ€æœ¯ç‚¹æ€»ç»“

### 7.1 ä¸ºä»€ä¹ˆæ”¾å¼ƒMermaid.jsï¼Ÿ

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|----------|
| Emojiæ¸²æŸ“ä¸ç¨³å®š | ä½¿ç”¨çº¯HTML+CSS |
| å¤æ‚è¯­æ³•å®¹æ˜“å‡ºé”™ | ç®€åŒ–ä¸ºåŸºç¡€HTMLç»“æ„ |
| æ ·å¼å®šåˆ¶å›°éš¾ | CSSå®Œå…¨å¯æ§ |
| åŠ è½½ä¾èµ–å¤§ | æ— éœ€é¢å¤–åº“ |

### 7.2 CSSæŠ€å·§

1. **è±å½¢èŠ‚ç‚¹**ï¼šä½¿ç”¨ `clip-path: polygon()` è£å‰ª
2. **æ¸å˜èƒŒæ™¯**ï¼š`linear-gradient()` åˆ›å»ºè§†è§‰å±‚æ¬¡
3. **æ‚¬åœåŠ¨ç”»**ï¼š`transform` + `transition` å¢å¼ºäº¤äº’æ„Ÿ
4. **å¼¹çª—åŠ¨ç”»**ï¼š`@keyframes` å®šä¹‰å…¥åœºåŠ¨ç”»

### 7.3 JSONè§£æå®¹é”™

1. æ”¯æŒå¤šç§JSONæ ¼å¼ï¼ˆæœ‰/æ— ä»£ç å—åŒ…è£¹ï¼‰
2. è‡ªåŠ¨ä¿®å¤ä¸å®Œæ•´çš„JSONï¼ˆè¡¥å…¨æ‹¬å·ï¼‰
3. è§£æå¤±è´¥æ—¶æ˜¾ç¤ºå‹å¥½æç¤º

---

## å…«ã€éƒ¨ç½²è¯´æ˜

### 8.1 Dockerfileå…³é”®é…ç½®

```dockerfile
# å¤åˆ¶æ‰€æœ‰å¿…è¦çš„Pythonæ–‡ä»¶
COPY app.py config.py app_xiaohang_enhanced.py ./

# å¤åˆ¶å‰ç«¯é™æ€æ–‡ä»¶
COPY static/ ./static/
```

### 8.2 é‡æ–°éƒ¨ç½²å‘½ä»¤

```bash
# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up --build -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f flask-ai-assistant
```

---

## ä¹ã€åç»­ä¼˜åŒ–æ–¹å‘

1. **ä»£ç æç¤ºå¢å¼º**ï¼šä¸ºç®€å•æ¨¡å—è‡ªåŠ¨ç”Ÿæˆå¯è¿è¡Œçš„ä»£ç æ¨¡æ¿
2. **åˆ†è§£å†å²å›æº¯**ï¼šæ”¯æŒæŸ¥çœ‹å’Œå›é€€åˆ°ä¹‹å‰çš„åˆ†è§£å±‚çº§
3. **å­¦ä¹ è¿›åº¦è¿½è¸ª**ï¼šè®°å½•å­¦ç”Ÿåœ¨æ¯ä¸ªæ¨¡å—çš„æŒæ¡æƒ…å†µ
4. **åä½œå­¦ä¹ **ï¼šæ”¯æŒå¤šäººåŒæ—¶æŸ¥çœ‹å’Œè®¨è®ºåˆ†è§£ç»“æœ
5. **å¯¼å‡ºåŠŸèƒ½**ï¼šå°†åˆ†è§£ç»“æœå¯¼å‡ºä¸ºPDFæˆ–å›¾ç‰‡

---

*æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0*  
*æ›´æ–°æ—¥æœŸï¼š2025å¹´12æœˆ28æ—¥*
