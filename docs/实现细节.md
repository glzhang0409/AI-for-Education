## äºŒã€æ ¸å¿ƒåŠŸèƒ½å®ç°ç»†èŠ‚

### åŠŸèƒ½1å®ç°ç»†èŠ‚ï¼šåˆ†è§£ç»ˆæ­¢è§„åˆ™

#### æç¤ºè¯ç¤ºä¾‹

```
ä½ æ˜¯ç¨‹åºè®¾è®¡æ•™å­¦ä¸“å®¶ï¼Œéœ€è¦å°†é—®é¢˜åˆ†è§£ä¸ºå­æ¨¡å—ã€‚

ã€åˆ†è§£ç»ˆæ­¢åˆ¤æ–­è§„åˆ™ã€‘ï¼š
å¯¹äºæ¯ä¸ªå­æ¨¡å—ï¼Œä½ å¿…é¡»åˆ¤æ–­æ˜¯å¦éœ€è¦ç»§ç»­åˆ†è§£ï¼š

1. ä»£ç è¡Œæ•°åˆ¤æ–­ï¼š
   - é¢„ä¼°ä»£ç  â‰¤ 10è¡Œ â†’ needsFurtherDecomposition: false
   - é¢„ä¼°ä»£ç  > 30è¡Œ â†’ needsFurtherDecomposition: true
   
2. å¤æ‚åº¦åˆ¤æ–­ï¼š
   - å•ä¸€æ“ä½œï¼ˆèµ‹å€¼ã€è¾“å‡ºã€ç®€å•è®¡ç®—ï¼‰â†’ false
   - åµŒå¥—å¾ªç¯ã€é€’å½’ã€å¤æ‚æ¡ä»¶ â†’ true
   
3. çŸ¥è¯†ç‚¹åˆ¤æ–­ï¼š
   - æ¶‰åŠ1ä¸ªçŸ¥è¯†ç‚¹ â†’ false
   - æ¶‰åŠ3ä¸ªä»¥ä¸ŠçŸ¥è¯†ç‚¹ â†’ true
   
4. å±‚çº§é™åˆ¶ï¼š
   - å½“å‰å±‚çº§ â‰¥ 5 â†’ å¼ºåˆ¶ false
   
5. å­¦ç”Ÿåé¦ˆï¼š
   - å­¦ç”Ÿæ˜ç¡®è¡¨ç¤º"å¯ä»¥å†™" â†’ false

ã€è¾“å‡ºæ ¼å¼ã€‘ï¼š
```json
{
  "subProblems": [{
    "name": "æ¨¡å—å",
    "needsFurtherDecomposition": true,
    "decompositionReason": "æ¶‰åŠ3ä¸ªçŸ¥è¯†ç‚¹ï¼šæŒ‡é’ˆã€é“¾è¡¨ã€é€’å½’ï¼Œé¢„ä¼°30è¡Œä»£ç ",
    "estimatedLines": 30,
    "complexity": "high",
    "knowledgePoints": ["æŒ‡é’ˆ", "é“¾è¡¨", "é€’å½’"]
  }]
}
```
```

#### å‰ç«¯å±•ç¤ºé€»è¾‘
```javascript
function renderDecompositionDecision(subProblem) {
    const canDecompose = subProblem.needsFurtherDecomposition;
    const reason = subProblem.decompositionReason;
    
    if (!canDecompose) {
        return `
        <div class="decomposition-final">
            <span class="badge badge-success">âœ… å·²è¾¾æœ€ç»†ç²’åº¦</span>
            <p class="reason">${reason}</p>
            <button class="btn-start-coding">å¼€å§‹ç¼–ç </button>
        </div>
        `;
    } else {
        return `
        <div class="decomposition-continue">
            <span class="badge badge-warning">ğŸ”„ å¯ç»§ç»­åˆ†è§£</span>
            <p class="reason">${reason}</p>
            <div class="action-buttons">
                <button class="btn-decompose">ç»§ç»­åˆ†è§£</button>
                <button class="btn-try-coding">æˆ‘è¯•è¯•å†™</button>
            </div>
        </div>
        `;
    }
}
```

---

### åŠŸèƒ½2å®ç°ç»†èŠ‚ï¼šISPOæ€è·¯åˆ†æ

#### æç¤ºè¯ç¤ºä¾‹
```
ä½ ç°åœ¨å¤„äºã€ISPOæ€è·¯åˆ†æã€‘é˜¶æ®µã€‚è¯·æŒ‰ç…§ä»¥ä¸‹ç»“æ„åˆ†æé—®é¢˜ï¼š

ã€I - Input è¾“å…¥åˆ†æã€‘
ä»é—®é¢˜ä¸­è¯†åˆ«éœ€è¦å¤„ç†çš„å¯¹è±¡ï¼š
- åˆ—å‡ºæ‰€æœ‰è¾“å…¥æ•°æ®
- åˆ†ææ•°æ®ç‰¹å¾å’Œçº¦æŸ
- è¯†åˆ«å…³é”®ä¿¡æ¯

ã€S - Storage å­˜å‚¨å»ºè®®ã€‘
é’ˆå¯¹ä¸Šè¿°å¯¹è±¡ï¼Œæä¾›å­˜å‚¨æ–¹æ¡ˆå»ºè®®ï¼ˆä¸ç»™ç¡®å®šç­”æ¡ˆï¼‰ï¼š
- æ–¹æ¡ˆ1ï¼šä½¿ç”¨XXæ•°æ®ç»“æ„ï¼Œä¼˜ç‚¹æ˜¯...ï¼Œé€‚åˆ...åœºæ™¯
- æ–¹æ¡ˆ2ï¼šä½¿ç”¨YYæ•°æ®ç»“æ„ï¼Œä¼˜ç‚¹æ˜¯...ï¼Œé€‚åˆ...åœºæ™¯
- æ–¹æ¡ˆ3ï¼šä½¿ç”¨ZZæ•°æ®ç»“æ„ï¼Œä¼˜ç‚¹æ˜¯...ï¼Œé€‚åˆ...åœºæ™¯
å¼•å¯¼é—®é¢˜ï¼š"ä½ è§‰å¾—å“ªç§æ–¹æ¡ˆæ›´é€‚åˆè¿™ä¸ªé—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"

ã€P - Process å¤„ç†åˆ†æã€‘
åˆ†ææ¶‰åŠçš„çŸ¥è¯†ç‚¹å’Œç®—æ³•ï¼ˆä¸ç»™å…·ä½“å®ç°ï¼‰ï¼š
- å¯èƒ½ç”¨åˆ°çš„ç®—æ³•ï¼šç®—æ³•Aã€ç®—æ³•Bã€ç®—æ³•C
- æ¶‰åŠçš„çŸ¥è¯†ç‚¹ï¼šçŸ¥è¯†ç‚¹1ã€çŸ¥è¯†ç‚¹2
- éœ€è¦æ³¨æ„çš„éš¾ç‚¹ï¼š...
å¼•å¯¼é—®é¢˜ï¼š"ä½ å¯¹è¿™äº›ç®—æ³•æœ‰äº†è§£å—ï¼Ÿå®ƒä»¬çš„æ—¶é—´å¤æ‚åº¦å¦‚ä½•ï¼Ÿ"

ã€O - Output è¾“å‡ºæ³¨æ„äº‹é¡¹ã€‘
åˆ†æè¾“å‡ºè¦æ±‚å’Œè¾¹ç•Œæƒ…å†µï¼š
- è¾“å‡ºæ ¼å¼è¦æ±‚
- ç‰¹æ®Šæƒ…å†µå¤„ç†ï¼ˆç©ºè¾“å…¥ã€è¾¹ç•Œå€¼ï¼‰
- æ€§èƒ½è€ƒè™‘
å¼•å¯¼é—®é¢˜ï¼š"ä½ èƒ½æƒ³åˆ°å“ªäº›ç‰¹æ®Šæƒ…å†µéœ€è¦å¤„ç†ï¼Ÿ"

ã€é‡è¦çº¦æŸã€‘ï¼š
1. ç»å¯¹ç¦æ­¢ç»™å‡ºç¡®å®šæ€§çš„è§£å†³æ–¹æ¡ˆ
2. å¿…é¡»æä¾›è‡³å°‘2ç§é€‰æ‹©è®©å­¦ç”Ÿæ€è€ƒ
3. æ¯ä¸ªéƒ¨åˆ†åé¢åŠ ä¸Šå¯å‘æ€§é—®é¢˜
4. ä¿æŒå¼€æ”¾æ€§ï¼Œé¼“åŠ±å­¦ç”Ÿåˆ›é€ æ€§æ€ç»´
```

#### å‰ç«¯å±•ç¤ºæ ¼å¼
```html
<div class="ispo-analysis">
    <div class="ispo-section input">
        <h4>ğŸ“¥ I - Input è¾“å…¥åˆ†æ</h4>
        <div class="content">...</div>
    </div>
    
    <div class="ispo-section storage">
        <h4>ğŸ’¾ S - Storage å­˜å‚¨å»ºè®®</h4>
        <div class="options">
            <div class="option">æ–¹æ¡ˆ1: ...</div>
            <div class="option">æ–¹æ¡ˆ2: ...</div>
            <div class="option">æ–¹æ¡ˆ3: ...</div>
        </div>
        <div class="question">ğŸ’­ ä½ è§‰å¾—å“ªç§æ–¹æ¡ˆæ›´é€‚åˆï¼Ÿ</div>
    </div>
    
    <div class="ispo-section process">
        <h4>âš™ï¸ P - Process å¤„ç†åˆ†æ</h4>
        <div class="content">...</div>
    </div>
    
    <div class="ispo-section output">
        <h4>ğŸ“¤ O - Output è¾“å‡ºæ³¨æ„</h4>
        <div class="content">...</div>
    </div>
</div>
```

---

### åŠŸèƒ½3å®ç°ç»†èŠ‚ï¼šæ·±åº¦ä»£ç åˆ†æä¸æ€è·¯çº é”™

#### æ ¸å¿ƒæç¤ºè¯è®¾è®¡

**æ€è·¯åˆ†ææç¤ºè¯æ¨¡æ¿**
```python
THOUGHT_ANALYSIS_PROMPT = """
ä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„ç®—æ³•æ•™å¸ˆï¼Œæ“…é•¿åˆ†æå­¦ç”Ÿçš„è§£é¢˜æ€è·¯ã€‚

ã€é¢˜ç›®ã€‘ï¼š
{problem_description}

ã€å­¦ç”Ÿä»£ç ã€‘ï¼š
{student_code}

è¯·è¿›è¡Œæ·±åº¦æ€è·¯åˆ†æï¼Œé‡ç‚¹å…³æ³¨ï¼š

1. ã€é¢˜ç›®ç†è§£ã€‘
   - å­¦ç”Ÿæ˜¯å¦æ­£ç¡®ç†è§£äº†è¾“å…¥è¾“å‡ºï¼Ÿ
   - æ˜¯å¦æ³¨æ„åˆ°é¢˜ç›®çš„çº¦æŸæ¡ä»¶ï¼Ÿ
   - æ˜¯å¦æŠ“ä½äº†é—®é¢˜çš„æœ¬è´¨ï¼Ÿ

2. ã€ç®—æ³•é€‰æ‹©ã€‘
   - å­¦ç”Ÿé€‰æ‹©çš„ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ
   - è¿™ä¸ªç®—æ³•èƒ½å¦æ­£ç¡®è§£å†³é—®é¢˜ï¼Ÿ
   - æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦å¦‚ä½•ï¼Ÿ
   - æ˜¯å¦æœ‰æ›´ä¼˜çš„ç®—æ³•ï¼Ÿ

3. ã€æ•°æ®ç»“æ„é€‰æ‹©ã€‘
   - å­¦ç”Ÿä½¿ç”¨äº†ä»€ä¹ˆæ•°æ®ç»“æ„ï¼Ÿ
   - è¿™ä¸ªæ•°æ®ç»“æ„æ˜¯å¦é€‚åˆè¿™ä¸ªé—®é¢˜ï¼Ÿ
   - æ˜¯å¦æœ‰æ›´åˆé€‚çš„æ•°æ®ç»“æ„ï¼Ÿ

4. ã€è¾¹ç•Œæƒ…å†µã€‘
   - å­¦ç”Ÿæ˜¯å¦è€ƒè™‘äº†ç©ºè¾“å…¥ï¼Ÿ
   - æ˜¯å¦è€ƒè™‘äº†æç«¯æƒ…å†µï¼Ÿ
   - æ˜¯å¦è€ƒè™‘äº†ç‰¹æ®Šå€¼ï¼Ÿ

5. ã€æ€ç»´è¯¯åŒºã€‘
   - å­¦ç”Ÿæœ‰å“ªäº›æ€ç»´è¯¯åŒºï¼Ÿ
   - ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè¿™äº›è¯¯åŒºï¼Ÿ
   - å¦‚ä½•å¼•å¯¼å­¦ç”Ÿèµ°å‡ºè¯¯åŒºï¼Ÿ

6. ã€æ”¹è¿›å»ºè®®ã€‘
   - æä¾›2-3ç§æ›´ä¼˜çš„è§£æ³•
   - æ¯ç§è§£æ³•è¯´æ˜ä¼˜ç¼ºç‚¹
   - ç»™å‡ºå­¦ä¹ å»ºè®®

7. ã€å¼•å¯¼é—®é¢˜ã€‘
   - è®¾è®¡3-5ä¸ªå¯å‘æ€§é—®é¢˜
   - å¼•å¯¼å­¦ç”Ÿè‡ªå·±å‘ç°é—®é¢˜
   - å¸®åŠ©å­¦ç”Ÿç†è§£æ›´ä¼˜è§£æ³•

è¾“å‡ºJSONæ ¼å¼ï¼š
{{
  "understanding": {{
    "score": 0-100,
    "analysis": "ç†è§£ç¨‹åº¦åˆ†æ",
    "issues": ["é—®é¢˜1", "é—®é¢˜2"]
  }},
  "algorithm": {{
    "current": "å½“å‰ç®—æ³•åç§°",
    "correct": true/false,
    "complexity": {{"time": "O(...)", "space": "O(...)"}},
    "issues": ["é—®é¢˜1", "é—®é¢˜2"],
    "better_options": [
      {{
        "name": "ç®—æ³•å",
        "complexity": {{"time": "O(...)", "space": "O(...)"}},
        "pros": ["ä¼˜ç‚¹1", "ä¼˜ç‚¹2"],
        "cons": ["ç¼ºç‚¹1"],
        "difficulty": "ç®€å•/ä¸­ç­‰/å›°éš¾"
      }}
    ]
  }},
  "dataStructure": {{
    "current": "å½“å‰æ•°æ®ç»“æ„",
    "appropriate": true/false,
    "issues": ["é—®é¢˜1"],
    "better_options": ["é€‰é¡¹1", "é€‰é¡¹2"]
  }},
  "boundaryHandling": {{
    "covered": ["å·²è€ƒè™‘çš„æƒ…å†µ"],
    "missing": ["é—æ¼çš„æƒ…å†µ"]
  }},
  "thinkingMistakes": [
    {{
      "type": "è¿‡åº¦å¤æ‚åŒ–/æ€ç»´å®šåŠ¿/å±€éƒ¨ä¼˜åŒ–/...",
      "description": "å…·ä½“æè¿°",
      "guidance": "å¦‚ä½•çº æ­£"
    }}
  ],
  "guidingQuestions": [
    "é—®é¢˜1ï¼š...",
    "é—®é¢˜2ï¼š...",
    "é—®é¢˜3ï¼š..."
  ],
  "overallAssessment": {{
    "score": 0-100,
    "level": "åˆå­¦è€…/è¿›é˜¶/é«˜çº§",
    "summary": "æ€»ä½“è¯„ä»·"
  }}
}}
"""
```

#### ç®—æ³•å¯¹æ¯”ç”Ÿæˆå™¨
```python
def generate_algorithm_comparison(current_algo, better_algos):
    """
    ç”Ÿæˆç®—æ³•å¯¹æ¯”è¡¨æ ¼
    """
    comparison = {
        "headers": ["æ–¹æ³•", "æ—¶é—´å¤æ‚åº¦", "ç©ºé—´å¤æ‚åº¦", "éš¾åº¦", "æ¨èåº¦"],
        "rows": []
    }
    
    # æ·»åŠ å­¦ç”Ÿçš„æ–¹æ³•
    comparison["rows"].append({
        "method": f"ä½ çš„æ–¹æ³•ï¼ˆ{current_algo['name']}ï¼‰",
        "time": current_algo['complexity']['time'],
        "space": current_algo['complexity']['space'],
        "difficulty": "â­" * current_algo['difficulty_stars'],
        "recommendation": "â­â­" if current_algo['correct'] else "â­"
    })
    
    # æ·»åŠ æ›´ä¼˜æ–¹æ³•
    for algo in better_algos:
        comparison["rows"].append({
            "method": algo['name'],
            "time": algo['complexity']['time'],
            "space": algo['complexity']['space'],
            "difficulty": "â­" * algo['difficulty_stars'],
            "recommendation": "â­" * algo['recommendation_stars']
        })
    
    return comparison
```

#### äº¤äº’å¼å¼•å¯¼ç³»ç»Ÿ
```python
class InteractiveGuidance:
    def __init__(self, thought_analysis):
        self.analysis = thought_analysis
        self.current_question = 0
        self.conversation_history = []
    
    def start_guidance(self):
        """å¼€å§‹äº¤äº’å¼å¼•å¯¼"""
        # ä»æœ€æ ¸å¿ƒçš„é—®é¢˜å¼€å§‹
        if self.analysis['thinkingMistakes']:
            return self.guide_thinking_mistake()
        elif not self.analysis['algorithm']['correct']:
            return self.guide_algorithm_choice()
        else:
            return self.guide_optimization()
    
    def guide_thinking_mistake(self):
        """å¼•å¯¼çº æ­£æ€ç»´è¯¯åŒº"""
        mistake = self.analysis['thinkingMistakes'][0]
        
        questions = [
            f"ä½ çš„ç®—æ³•æ—¶é—´å¤æ‚åº¦æ˜¯{self.analysis['algorithm']['complexity']['time']}ï¼Œ",
            f"å¦‚æœæ•°æ®è§„æ¨¡å¾ˆå¤§ä¼šæ€æ ·ï¼Ÿ",
            f"ä½ çŸ¥é“æœ‰å“ªäº›æ•°æ®ç»“æ„å¯ä»¥ä¼˜åŒ–è¿™ä¸ªæ“ä½œå—ï¼Ÿ"
        ]
        
        return {
            "type": "thinking_mistake",
            "mistake": mistake,
            "questions": questions
        }
    
    def process_answer(self, user_answer):
        """å¤„ç†å­¦ç”Ÿå›ç­”"""
        # ä½¿ç”¨LLMè¯„ä¼°å›ç­”è´¨é‡
        evaluation = self.evaluate_answer(user_answer)
        
        if evaluation['correct']:
            return self.next_question()
        else:
            return self.provide_hint()
```

---

### åŠŸèƒ½4å®ç°ç»†èŠ‚ï¼šçŸ¥è¯†æ¼æ´è¿½è¸ª

#### æ•°æ®é‡‡é›†ç‚¹
```python
# é‡‡é›†ç‚¹1ï¼šç”¨æˆ·æé—®
@app.route('/api/ask', methods=['POST'])
def ask():
    question = request.json.get('question')
    
    # æå–çŸ¥è¯†ç‚¹
    knowledge_points = extract_knowledge_points(question)
    
    # è®°å½•åˆ°ç”¨æˆ·æ¡£æ¡ˆ
    update_user_profile(user_id, {
        'questions': knowledge_points,
        'timestamp': time.time()
    })
    
    # ... åŸæœ‰é€»è¾‘

# é‡‡é›†ç‚¹2ï¼šä»£ç æäº¤
@app.route('/api/submit_code', methods=['POST'])
def submit_code():
    code = request.json.get('code')
    errors = analyze_code(code)
    
    # è®°å½•é”™è¯¯ç±»å‹
    update_user_profile(user_id, {
        'errors': errors,
        'timestamp': time.time()
    })
    
    # ... åŸæœ‰é€»è¾‘

# é‡‡é›†ç‚¹3ï¼šåˆ†è§£å±‚çº§
@app.route('/api/xiaohang/decompose_problem', methods=['POST'])
def decompose_problem():
    level = request.json.get('level')
    
    # è®°å½•åˆ†è§£æ·±åº¦
    update_user_profile(user_id, {
        'decomposition_depth': level,
        'timestamp': time.time()
    })
    
    # ... åŸæœ‰é€»è¾‘
```

#### çŸ¥è¯†å›¾è°±ç”Ÿæˆ
```python
def generate_knowledge_graph(user_profile):
    graph = {
        'nodes': [],
        'edges': [],
        'mastery': {}
    }
    
    # æ·»åŠ çŸ¥è¯†ç‚¹èŠ‚ç‚¹
    for kp in KNOWLEDGE_POINTS:
        mastery = calculate_mastery(user_profile, kp)
        graph['nodes'].append({
            'id': kp,
            'label': kp,
            'mastery': mastery,
            'color': get_color_by_mastery(mastery)
        })
    
    # æ·»åŠ ä¾èµ–å…³ç³»è¾¹
    for dep in KNOWLEDGE_DEPENDENCIES:
        graph['edges'].append({
            'from': dep['prerequisite'],
            'to': dep['target']
        })
    
    return graph
```

---

### åŠŸèƒ½5å®ç°ç»†èŠ‚ï¼šæ™ºèƒ½æç¤ºè¯é€‰æ‹©

#### ç­–ç•¥é€‰æ‹©é€»è¾‘
```python
def select_prompt_strategy(user_id, question):
    # è·å–ç”¨æˆ·æ¡£æ¡ˆ
    profile = get_user_profile(user_id)
    
    # è®¡ç®—å„ç»´åº¦å¾—åˆ†
    mastery_score = calculate_overall_mastery(profile)
    error_frequency = get_error_frequency(profile)
    knowledge_gaps = identify_critical_gaps(profile)
    
    # å†³ç­–æ ‘
    if mastery_score < 0.3:
        return STRATEGIES['beginner']
    elif error_frequency > 10 and has_repeated_pattern(profile):
        return STRATEGIES['error_correction']
    elif len(knowledge_gaps) > 3:
        return STRATEGIES['knowledge_è¡¥æ¼']
    elif mastery_score > 0.8:
        return STRATEGIES['advanced']
    else:
        return STRATEGIES['intermediate']
```

#### åŠ¨æ€æç¤ºè¯ç»„è£…
```python
def generate_dynamic_prompt(base_prompt, strategy, user_profile):
    # åŸºç¡€æç¤ºè¯
    prompt = base_prompt
    
    # æ·»åŠ ç­–ç•¥ä¿®é¥°
    prompt += f"\n\n{strategy['modifier']}"
    
    # æ·»åŠ ä¸ªæ€§åŒ–å†…å®¹
    weak_points = get_weak_knowledge_points(user_profile)
    if weak_points:
        prompt += f"\n\nã€ä¸ªæ€§åŒ–æç¤ºã€‘ï¼šæˆ‘æ³¨æ„åˆ°ä½ åœ¨{weak_points}æ–¹é¢è¿˜éœ€è¦åŠ å¼ºã€‚"
    
    # æ·»åŠ é¼“åŠ±è¯­
    if strategy['type'] == 'beginner':
        prompt += "\n\nä¸è¦æ‹…å¿ƒï¼Œæˆ‘ä¼šä¸€æ­¥æ­¥å¼•å¯¼ä½ ã€‚"
    
    return prompt
```

---

