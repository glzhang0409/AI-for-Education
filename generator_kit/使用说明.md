# Generator Kit 使用说明

## 快速开始

### 1. 安装依赖

```bash
pip install openai
```

### 2. 配置 API

编辑 `config.py` 文件，修改 API 配置：

```python
LLM_CONFIG = {
    "api_key": "your-api-key-here",  # 修改这里！
    "base_url": "https://console.siflow.cn/siflow/longmen/skyinfer/wzhang/loopcoder/v1/8020/v1",
    "model": "loopcoder",
    "timeout": 120,
    "max_retries": 3,
}
```

### 3. 运行示例

有两个脚本可以运行：

#### 方式 A: 运行完整示例（推荐）

```bash
cd /home/gaiyiming/programmate_20260204/generator_kit
python example_usage.py
```

这个脚本会：
- ✓ 检查依赖是否安装
- ✓ 检查配置是否正确
- ✓ 测试 API 连接
- ✓ 运行两个完整示例
- ✓ 将测试点保存到文件

#### 方式 B: 运行简单测试

```bash
cd /home/gaiyiming/programmate_20260204/generator_kit
python test.py
```

## 使用示例

### 示例 1: 一行式调用

```python
from generator_kit import generate_cases

problem_text = """
题目描述: 计算两个整数的和
输入格式: 两个整数 a b
输出格式: a+b 的值
数据范围: -1000 <= a, b <= 1000
"""

# 生成 5 个测试点
testcases = generate_cases(problem_text, count=5)

for tc in testcases:
    print(f"输入: {tc['input']}")
    print(f"输出: {tc['output']}")
```

### 示例 2: 使用完整 API

```python
from generator_kit import ProblemParser, TestCaseGenerator

# 1. 解析题目
parser = ProblemParser()
problem = parser.parse_from_text(problem_text)

# 2. 生成测试点
generator = TestCaseGenerator()
result = generator.generate(problem, count=10)

# 3. 查看结果
print(f"生成了 {len(result.testcases)} 个测试点")
print(f"使用策略: {[s.value for s in result.strategies_used]}")

# 4. 保存到文件
generator.save_testcases(result, output_dir="./testcases")
generator.save_testcases_to_json(result, output_file="./testcases.json")
```

## 常见问题

### Q1: 运行脚本后没有任何输出？

**A:** 可能是以下原因：
1. API Key 未配置或配置错误
2. 网络连接问题
3. API 服务不可用

**解决方法：**
- 运行 `example_usage.py`，它会显示详细的错误信息和诊断
- 检查 `config.py` 中的 `api_key` 是否正确

### Q2: 提示缺少 openai 库？

```bash
pip install openai
```

### Q3: API 连接超时？

**A:** 可能的原因：
1. 网络问题
2. API 服务不可用
3. base_url 配置错误

**解决方法：**
- 检查网络连接
- 确认 `config.py` 中的 `base_url` 是否正确
- 增加 `timeout` 值（默认 120 秒）

### Q4: 生成的测试点数量不对？

**A:** 默认配置生成 10 个测试点。可以通过以下方式调整：

方法 1: 在调用时指定数量
```python
testcases = generate_cases(problem_text, count=20)  # 生成 20 个
```

方法 2: 修改配置文件
```python
# config.py
TESTCASE_CONFIG = {
    "default_count": 20,  # 修改默认数量
    ...
}
```

## 输出文件

运行示例后，会在以下位置生成文件：

```
generator_kit/
├── testcases_output/          # 测试点目录
│   ├── test1.in              # 测试点 1 输入
│   ├── test1.out             # 测试点 1 输出
│   ├── test2.in
│   ├── test2.out
│   └── ...
└── testcases_output/
    └── testcases.json        # JSON 格式的所有测试点
```

## 调试技巧

### 查看详细日志

在代码中添加 print 语句：

```python
from generator_kit import generate_cases

print("开始生成...")
testcases = generate_cases(problem_text, count=5)
print(f"生成完成，共 {len(testcases)} 个")
```

### 测试 API 连接

```python
from generator_kit.llm_client import get_client

client = get_client()
is_connected = client.test_connection()
print(f"连接状态: {is_connected}")
```

### 查看题目解析结果

```python
from generator_kit import ProblemParser

parser = ProblemParser()
problem = parser.parse_from_text(problem_text)

print(f"标题: {problem.title}")
print(f"约束: {problem.constraints}")
print(f"可能溢出: {problem.may_have_overflow}")
```

## 项目结构

```
generator_kit/
├── __init__.py              # 统一接口
├── config.py                # 配置文件
├── llm_client.py            # LLM 客户端
├── models.py                # 数据模型
├── problem_parser.py        # 题目解析器
├── testcase_generator.py    # 测试点生成器
├── test.py                  # 简单测试脚本
├── example_usage.py         # 完整示例脚本
└── 使用说明.md              # 本文件
```

## 技术支持

如果遇到问题：
1. 查看 `example_usage.py` 的输出，它包含详细的诊断信息
2. 检查 Python 版本（需要 3.6+）
3. 确认所有依赖已安装
4. 验证 API 配置正确
